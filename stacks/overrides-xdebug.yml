# Adds to the project separate cli container with xdebug enabled
# The xdebug can be accessed at xdebug-${VIRTUAL_HOST}

version: "2.1"

services:
  cli-xdebug:
    extends:
      file: ${HOME}/.docksal/stacks/services.yml
      service: cli
    hostname: cli-xdebug
    environment:
      # Point xdebug to the dbgp server (started by IDE) in the ide container.
      # This is only necessary for debugging php cli sessions initiated directly in the IDE.
      # Normally, you'd be launching a cli script manually inside the cli container and not inside IDE (ide container).
      - XDEBUG_CONFIG=remote_host=xdebug remote_port=9000
      - VIRTUAL_HOST=xdebug-${VIRTUAL_HOST}
      - DRUSH_OPTIONS_URI=xdebug-${VIRTUAL_HOST}
